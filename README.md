# Проект "YaMDb"

## Описание проекта:
 **Проект YaMDb** собирает отзывы (Review) пользователей на произведения (Titles). Произведения делятся на категории: «Книги», «Фильмы», «Музыка». Список категорий (Category) может быть расширен администратором (например, можно добавить категорию «Изобразительное искусство» или «Ювелирка»).
 Сами произведения в YaMDb не хранятся, здесь нельзя посмотреть фильм или послушать музыку.
 В каждой категории есть произведения: книги, фильмы или музыка. Например, в категории «Книги» могут быть произведения «Винни-Пух и все-все-все» и «Марсианские хроники», а в категории «Музыка» — песня «Давеча» группы «Насекомые» и вторая сюита Баха.
 Произведению может быть присвоен жанр (Genre) из списка предустановленных (например, «Сказка», «Рок» или «Артхаус»). Новые жанры может создавать только администратор.
 Благодарные или возмущённые пользователи оставляют к произведениям текстовые отзывы (Review) и ставят произведению оценку в диапазоне от одного до десяти (целое число); из пользовательских оценок формируется усреднённая оценка произведения — рейтинг (целое число). На одно произведение пользователь может оставить только один отзыв.

## Используемые технологии:
- [Python 3.7](https://www.python.org/)
- [DRF](https://www.django-rest-framework.org/)
- [JWT](https://django-rest-framework-simplejwt.readthedocs.io/en/latest/)


## Как запустить проект:
1. Клонируем репозиторий к себе на компьютер:
```
    git@github.com:frajik/api_yamdb.git
```

2. Переходим в репозиторий:
```
    cd api_yamdb
```

3. Создаем и активируем рабочее окружение:
```
    - python -m venv venv
    - source venv/scripts/activate
```

4. Устанавливаем зависимости из файла requirements.txt:
```
    - python -m pip install --upgrade pip
    -pip install -r requirements.txt
```

5. Выполняем миграции:
```
    - python manage.py migrate
```

6. Запускаем проект:
```
    - python manage.py runserver
```
## Пользовательские роли

- Аноним — может просматривать описания произведений, читать отзывы и комментарии.
- Аутентифицированный пользователь (user) — может читать всё, как и Аноним, может публиковать отзывы и ставить оценки произведениям (фильмам/книгам/песенкам), может комментировать отзывы; может редактировать и удалять свои отзывы и комментарии, редактировать свои оценки произведений. Эта роль присваивается по умолчанию каждому новому пользователю.
- Модератор (moderator) — те же права, что и у Аутентифицированного пользователя, плюс право удалять и редактировать любые отзывы и комментарии.
- Администратор (admin) — полные права на управление всем контентом проекта. Может создавать и удалять произведения, категории и жанры. Может назначать роли пользователям.
- Суперюзер Django должен всегда обладать правами администратора, пользователя с правами admin. Даже если изменить пользовательскую роль суперюзера — это не лишит его прав администратора. Суперюзер — всегда администратор, но администратор — не обязательно суперюзер.

## Регистрация новых пользователей

1. Пользователь отправляет POST-запрос с параметрами email и username на эндпоинт /api/v1/auth/signup/.
2. Сервис YaMDB отправляет письмо с кодом подтверждения (confirmation_code) на указанный адрес email.
3. Пользователь отправляет POST-запрос с параметрами username и confirmation_code на эндпоинт /api/v1/auth/token/, в ответе на запрос ему приходит token (JWT-токен).

В результате пользователь получает токен и может работать с API проекта, отправляя этот токен с каждым запросом.
После регистрации и получения токена пользователь может отправить PATCH-запрос на эндпоинт /api/v1/users/me/ и заполнить поля в своём профайле (описание полей — в документации).


## Ресурсы API YaMDb
- Ресурс auth: аутентификация.
- Ресурс users: пользователи.
- Ресурс titles: произведения, к которым пишут отзывы (определённый фильм, книга или песенка).
- Ресурс categories: категории (типы) произведений («Фильмы», «Книги», «Музыка»).
- Ресурс genres: жанры произведений. Одно произведение может быть привязано к нескольким жанрам.
- Ресурс reviews: отзывы на произведения. Отзыв привязан к определённому произведению.
- Ресурс comments: комментарии к отзывам. Комментарий привязан к определённому отзыву.

## Примеры запросов:

Получение списка всех произведений

` GET /api/v1/titles/`

Результат:
```
{
    "count": 32,
    "next": "http://127.0.0.1:8000/api/v1/titles/?page=2",
    "previous": null,
    "results": [
        {
            "id": 3,
            "name": "12 разгневанных мужчин",
            "year": 1957,
            "description": "",
            "genre": [],
            "category": {
                "name": "Фильм",
                "slug": "movie"
            },
            "rating": 7
        },
        {
            "id": 30,
            "name": "Deep Purple — Smoke on the Water",
            "year": 1971,
            "description": "",
            "genre": [],
            "category": {
                "name": "Музыка",
                "slug": "music"
            },
            "rating": 10
        },

    ]
}
```
Получение списка всех жанров

` GET /api/v1/titles/`

Результат:
```
{
    "count": 15,
    "next": "http://127.0.0.1:8000/api/v1/genres/?page=2",
    "previous": null,
    "results": [
        {
            "name": "Драма",
            "slug": "drama"
        },
        {
            "name": "Комедия",
            "slug": "comedy"
        },
        {
            "name": "Вестерн",
            "slug": "western"
        },
        {
            "name": "Фэнтези",
            "slug": "fantasy"
        },
        {
            "name": "Фантастика",
            "slug": "sci-fi"
        }
    ]
}
```
Получить список всех отзывов к определенному произведению по его id

`GET /api/v1/titles/1/reviews/`

`GET /api/v1/titles/{title_id}/reviews/`

Результат:

```
{
    "count": 2,
    "next": null,
    "previous": null,
    "results": [
        {
            "id": 1,
            "text": "Ставлю десять звёзд!\n...Эти голоса были чище и светлее тех, о которых мечтали в этом сером, убогом месте. Как будто две птички влетели и своими голосами развеяли стены наших клеток, и на короткий миг каждый человек в Шоушенке почувствовал себя свободным.",
            "title": "Побег из Шоушенка",
            "author": "bingobongo",
            "score": 10,
            "pub_date": "2022-11-11T10:29:55.514545Z"
        },
        {
            "id": 2,
            "text": "Не привыкай\n«Эти стены имеют одно свойство: сначала ты их ненавидишь, потом привыкаешь, а потом не можешь без них жить»",
            "title": "Побег из Шоушенка",
            "author": "capt_obvious",
            "score": 10,
            "pub_date": "2022-11-11T10:29:55.619551Z"
        }
    ]
}
```
Получить список всех комментариев к отзыву по id

`GET /api/v1/titles/{title_id}/reviews/{review_id}/comments/`

`GET /api/v1/titles/1/reviews/6/comments/`

Результаты: 
```
{
    "count": 3,
    "next": null,
    "previous": null,
    "results": [
        {
            "id": 1,
            "author": "faust",
            "review": "Всё, как в разных языках программирования! В основном — похоже..." 
            "pub_date": "2022-11-11T10:33:39.957382Z"
        },
        .
        .
        .    
    ]
}
```

## Документация API:
- При запущенном проекте, для API Yatube, будет доступна полная документация, в формате Redoc, по адресу:
```
http://127.0.0.1:8000/redoc/
```

### Авторы:

- Матвейчук Дмитрий (тимлид): управление пользователями (Auth и Users): система регистрации и аутентификации пользователей, пользовательские роли и права доступа, работа с токеном, система подтверждения через e-mail.

- Галкин Виталий (разработчик): категории (Categories), жанры (Genres) и произведения (Titles): модели, view и эндпойнты.

- Чернышева Марина (разработчик): отзывы (Review) и комментарии (Comments): модели, view и эндпойнты, рейтинги
